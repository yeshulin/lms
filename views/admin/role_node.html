<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Data-Table 表格</title>
    <link rel="stylesheet" href="/static/vipadmin/frame/layui/css/layui.css">
    <!--<link rel="stylesheet" href="/static/vipadmin/css/jquery.dataTables.min.css">-->
    <link rel="stylesheet" href="/static/vipadmin/css/style.css">
    <link rel="icon" href="/static/vipadmin/image/code.png">
</head>
<body class="body">

<fieldset class="layui-elem-field layui-field-title">
    <legend>
        <span class="layui-breadcrumb">
            <a href="/admin">首页</a>
            <a><cite>角色用户</cite></a>
			<a><cite>{{.role.Name}}</cite></a>
        </span>
    </legend>
</fieldset>

<form class="layui-form" id="user-form">
<div class="layui-form-item">
	<label class="layui-form-label">{{.role.Name}}</label>
</div>	
 <div class="layui-form-item">
	 <div class="layui-input-block">
        <!--主菜单-->
        <input type="checkbox" name="" title="系统设置" lay-skin="primary" lay-filter="allChoose">
        <div style="margin-left: 50px;" class="checked-box">
            <!--二级菜单-->
            <div class="checked2">
                <input type="checkbox" name="" title="用户管理" lay-skin="primary" lay-filter="allChoose2">
                <div style="margin-left: 50px;" class="checked-child">
                    <input type="checkbox" name="" title="添加用户" lay-skin="primary">
                    <input type="checkbox" name="" title="编辑用户" lay-skin="primary">
                    <input type="checkbox" name="" title="删除用户" lay-skin="primary">
                </div>
            </div>
            <!--二级菜单-->
            <div class="checked2">
                <input type="checkbox" name="" title="角色管理" lay-skin="primary" lay-filter="allChoose2">
                <div style="margin-left: 50px;" class="checked-child">
                    <input type="checkbox" name="" title="添加角色" lay-skin="primary">
                    <input type="checkbox" name="" title="编辑角色" lay-skin="primary">
                    <input type="checkbox" name="" title="删除角色" lay-skin="primary">
                </div>
            </div>

            <!--二级菜单-->
            <div class="checked2">
                <input type="checkbox" name="" title="网关组管理" lay-skin="primary" lay-filter="allChoose2">
                <div style="margin-left: 50px;" class="checked-child">
                    <input type="checkbox" name="" title="管理组" lay-skin="primary">
                </div>
            </div>
            <!--二级菜单-->
            <div class="checked2">
                <input type="checkbox" name="" title="配置管理" lay-skin="primary" lay-filter="allChoose2">
                <div style="margin-left: 50px;" class="checked-child">
                    <input type="checkbox" name="" title="添加配置" lay-skin="primary">
                    <input type="checkbox" name="" title="编辑配置" lay-skin="primary">
                    <input type="checkbox" name="" title="删除配置" lay-skin="primary">
                </div>
            </div>
        </div>
    </div>
</div>
</form>	


<script type="text/javascript" src="/static/vipadmin/frame/layui/layui.js"></script>
<!-- jQuery -->
<script type="text/javascript" charset="utf8" src="/static/vipadmin/js/jquery.js"></script>
<script type="text/javascript" src="/static/vipadmin/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="/static/vipadmin/js/table-tool.js"></script>
<script type="text/javascript">
    layui.use(['element','form'], function(){
        
		var form = layui.form();

       
		form.on('checkbox(allChoose)', function(data){
		   var child = $(data.elem).parent('.layui-input-block').find('.checked-box :checkbox');
		   child.each(function(index, item){
		       item.checked = data.elem.checked;
		   });
		   form.render('checkbox');
		});
		 form.on('checkbox(allChoose2)', function(data){
//              var child2 = $(data.elem).siblings('.checked-child').find(':checkbox');
                var child2 = $(data.elem).parent('.checked2').find('.checked-child :checkbox');
                child2.each(function(index, item){
                    item.checked = data.elem.checked;
                });
                form.render('checkbox');
            });

		//监听提交
        form.on('submit(demo1)', function(data){
            layer.alert(JSON.stringify(data.field), {
                title: '最终的提交信息'
            });

			//console.log(data.field);
			//return false;
			$.post("/admin/role/adduser",data.field,function(data){
				console.log(data);
				if(data.code==1){
					 layer.msg('添加用户成功，正为你跳转！', {
		                icon: 16
		                ,shade: 0.01
		            });
					window.location="/admin/role/user?id="+{{.role.Id}};
				}else{
					layer.msg('添加用户失败！');
				}
			},"json")
			return false;
        });
    });
	 
</script>
</body>
</html>